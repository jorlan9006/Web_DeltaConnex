<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Untitled Page</title>
<meta name="generator" content="WYSIWYG Web Builder 20 - https://www.wysiwygwebbuilder.com">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="delta_connex.css" rel="stylesheet">
<link href="Account.css" rel="stylesheet">
</head>
<body>
<div id="wb_LayoutGrid3">
<div id="LayoutGrid3">
<div class="col-1">
<div id="wb_LayoutGrid2">
<div id="LayoutGrid2">
<div class="col-1">
<picture id="wb_Picture1" style="display:block;width: 100%;height:38px;z-index:0">
<img src="logo.png" id="Picture1" alt="" width="33" height="29">
</picture>
</div>
<div class="col-2">
<hr id="HorizontalLine1" style="display:inline-block;width:168px;z-index:1;">
<div id="wb_Text1">
<span style="color:#000000;font-family:Arial;font-size:16px;"><strong>DELTA CONNEX</strong></span>
</div>
</div>
</div>
</div>
</div>
<div class="col-2">
<div id="FlexContainer1">
<button type="submit" id="ThemeableButton3" name="" value="Money" class="ui-button ui-corner-all" style="display:block;width:74px;height:22px;z-index:4;">Money</button>
<button type="submit" id="ThemeableButton4" name="" value="Percentage" class="ui-button ui-corner-all" style="display:block;width:74px;height:22px;z-index:5;">Percentage</button>
</div>
</div>
<div class="col-3">
</div>
</div>
</div>
<div id="wb_LayoutGrid5">
<div id="LayoutGrid5">
<div class="row">
<div class="col-1">
<hr id="HorizontalLine2" style="display:inline-block;width:160px;z-index:31;">
<div id="wb_LayoutGrid6">
<div id="LayoutGrid6">
<div class="row">
<div class="col-1">
<div id="wb_Text2">
<span style="color:#424851;font-family:Arial;font-size:13px;"><strong>GENERAL</strong></span>
</div>
</div>
</div>
</div>
</div>
<div id="wb_LayoutGrid4" onclick="window.location.href='./Dashboard.html';return false;">
<div id="LayoutGrid4">
<div class="col-1">
<div id="wb_Icon1" style="display:inline-block;width:14px;height:22px;text-align:center;z-index:13;">
<div id="Icon1"><i class="Icon1"></i></div>
</div>
</div>
<div class="col-2">
<input type="submit" id="Button2" name="" value="Dashboard" style="display:block;width: 100%;;height:19px;z-index:14;">
</div>
</div>
</div>
<div id="wb_LayoutGrid7" onclick="window.location.href='./Calendar.html';return false;">
<div id="LayoutGrid7">
<div class="col-1">
<div id="wb_Icon2" style="display:inline-block;width:14px;height:22px;text-align:center;z-index:15;">
<div id="Icon2"><i class="Icon2"></i></div>
</div>
</div>
<div class="col-2">
<input type="submit" id="Button1" name="" value="Calendar  " style="display:block;width: 100%;;height:19px;z-index:16;">
</div>
</div>
</div>
<div id="wb_LayoutGrid1" onclick="window.location.href='./Account.html';return false;">
<div id="LayoutGrid1">
<div class="col-1">
<div id="wb_Icon3" style="display:inline-block;width:14px;height:25px;text-align:center;z-index:17;">
<div id="Icon3"><i class="Icon3"></i></div>
</div>
</div>
<div class="col-2">
<input type="submit" id="Button3" name="" value="Accounts   " style="display:block;width: 100%;;height:19px;z-index:18;">
</div>
</div>
</div>
<div id="wb_LayoutGrid8">
<div id="LayoutGrid8">
<div class="row">
<div class="col-1">
<div id="wb_Text8">
<span style="color:#424851;font-family:Arial;font-size:13px;"><strong>TRADING</strong></span>
</div>
</div>
</div>
</div>
</div>
<div id="wb_LayoutGrid10" onclick="window.location.href='./Trades.html';return false;">
<div id="LayoutGrid10">
<div class="col-1">
<div id="wb_Icon5" style="display:inline-block;width:14px;height:22px;text-align:center;z-index:20;">
<div id="Icon5"><i class="Icon5"></i></div>
</div>
</div>
<div class="col-2">
<input type="submit" id="Button4" name="" value="Trades   " style="display:block;width: 100%;;height:19px;z-index:21;">
</div>
</div>
</div>
<div id="wb_LayoutGrid11" onclick="window.location.href='./Analytics.html';return false;">
<div id="LayoutGrid11">
<div class="col-1">
<div id="wb_Icon6" style="display:inline-block;width:14px;height:22px;text-align:center;z-index:22;">
<div id="Icon6"><i class="Icon6"></i></div>
</div>
</div>
<div class="col-2">
<input type="submit" id="Button5" name="" value="Analytics " style="display:block;width: 100%;;height:19px;z-index:23;">
</div>
</div>
</div>
<div id="wb_LayoutGrid9" onclick="window.location.href='./Progress-Tracker.html';return false;">
<div id="LayoutGrid9">
<div class="col-1">
<div id="wb_Icon4" style="display:inline-block;width:14px;height:22px;text-align:center;z-index:24;">
<div id="Icon4"><i class="Icon4"></i></div>
</div>
</div>
<div class="col-2">
<input type="submit" id="Button6" name="" value="Progress Tracker " style="display:block;width: 100%;;height:19px;z-index:25;">
</div>
</div>
</div>
<div id="wb_LayoutGrid12">
<div id="LayoutGrid12">
<div class="row">
<div class="col-1">
<div id="wb_Text12">
<span style="color:#424851;font-family:Arial;font-size:13px;"><strong>STRATEGY</strong></span>
</div>
</div>
</div>
</div>
</div>
<div id="wb_LayoutGrid13" onclick="window.location.href='./Strategies.html';return false;">
<div id="LayoutGrid13">
<div class="col-1">
<div id="wb_Icon7" style="display:inline-block;width:14px;height:22px;text-align:center;z-index:27;">
<div id="Icon7"><i class="Icon7"></i></div>
</div>
</div>
<div class="col-2">
<input type="submit" id="Button7" name="" value="Strategies" style="display:block;width: 100%;;height:19px;z-index:28;">
</div>
</div>
</div>
<div id="wb_LayoutGrid14" onclick="window.location.href='./Backtesting.html';return false;">
<div id="LayoutGrid14">
<div class="col-1">
<div id="wb_Icon8" style="display:inline-block;width:14px;height:21px;text-align:center;z-index:29;">
<div id="Icon8"><i class="Icon8"></i></div>
</div>
</div>
<div class="col-2">
<input type="submit" id="Button8" name="" value="Backtesting" style="display:block;width: 100%;;height:19px;z-index:30;">
</div>
</div>
</div>
</div>
<div class="col-2">
<div id="wb_LayoutGrid16">
<div id="LayoutGrid16">
<div class="col-1">
<div id="wb_LayoutGrid21">
<div id="LayoutGrid21">
<div class="col-1">
<div id="wb_Text5">
<span style="color:#000000;font-family:Arial;font-size:21px;"><strong>Trading Accounts</strong></span>
</div>
</div>
<div class="col-2">
<button type="submit" id="ThemeableButton1" name="" value="Add Account" class="ui-button ui-corner-all" style="display:inline-block;width:96px;height:25px;z-index:44;"><span class="ui-button-icon ui-icon ui-primary"></span><span class="ui-button-icon-space"> </span>Add Account</button>
</div>
</div>
</div>
<div id="wb_LayoutGrid19">
<div id="LayoutGrid19">
<div class="col-1">
<div id="Html1" style="display:inline-block;width:100%;height:672px;overflow:hidden;z-index:45">
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Dashboard Cuentas MT5</title>
  </head>
<body>

  <div id="dashboard"></div>
  <div class="last-update" id="lastUpdate"></div>

  <script>
    async function fetchData() {
      try {
        const res = await fetch("http://127.0.0.1:8000/dashboard/data");
        const data = await res.json();
        const container = document.getElementById("dashboard");
        const lastUpdateDiv = document.getElementById("lastUpdate");

        container.innerHTML = "";

        if (Object.keys(data).length === 0) {
          container.innerHTML = "<div class='no-data'>üì≠ No hay datos disponibles a√∫n.</div>";
          return;
        }

        Object.entries(data).forEach(([accountId, d]) => {
          const card = document.createElement("div");
          card.className = "card";

          card.innerHTML = `
            <h2>${d.broker || 'Broker desconocido'}</h2>
            <div class="platform">Metatrader 5</div>

            <div class="balance">
              $${Number(d.balance).toLocaleString('en-US', {minimumFractionDigits: 0})}
            </div>
            <div class="label">Current Balance</div>

            <div class="initial-balance">
              $${Number(d.initial_balance || 0).toLocaleString('en-US', {minimumFractionDigits: 0})}
            </div>
            <div class="label">Initial Balance</div>
          `;

          container.appendChild(card);
        });

        const now = new Date();
        lastUpdateDiv.innerHTML = `‚è∞ √öltima actualizaci√≥n: ${now.toLocaleString()}`;

      } catch (err) {
        console.error("‚ùå No hay cuentas conectadas:", err);
        document.getElementById("dashboard").innerHTML = 
          "<div class='error'>‚ùå No hay cuentas conectadas.</div>";
      }
    }

    setInterval(fetchData, 5000);
    fetchData();
  </script>
</body>
</html>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</body>
</html>